(window.webpackJsonp=window.webpackJsonp||[]).push([[4],[,,,function(e,n,t){e.exports=t.p+"fa5a0a5aaf3729e50f675ddb88a87562.webp"},,,,,,,,,,function(e,n,t){e.exports=t.p+"373f609056c9cb8e0462f6f830412023.webp"},function(e,n,t){e.exports=t.p+"f8a46462db8fc96fa6d7ad718508ae65.webp"},,,function(e,n,t){t(18),e.exports=t(43)},,,,,,,,,,,,,,,function(e,n,t){var a={"./0-title.mdx":33,"./01-introduction/0-title.mdx":34,"./01-introduction/01-commonjs.md":35,"./01-introduction/02-ecmascript.md":36,"./01-introduction/03-summary.md":37,"./02-quirks/01-cycles/01-cycles.md":38,"./02-quirks/01-cycles/02-solution.md":39,"./02-quirks/01-cycles/03-ecmascript.md":40,"./02-quirks/02-monkey-patching.md":41,"./03-typescript/0-title.md":42};function o(e){var n=r(e);return t(n)}function r(e){if(!t.o(a,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=32},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return s})),t.d(n,"fusumaProps",(function(){return m})),t.d(n,"default",(function(){return d}));var a=t(5),o=t(2),r=t.n(o),l=t(1);function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}function u(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=[function(e){return Object(l.a)(r.a.Fragment,null,Object(l.a)(a.a,(n={left:Object(l.a)("img",{src:t(13)}),right:Object(l.a)("div",{className:"alignleft"},Object(l.a)("h1",null,"Модули в Node.js и TypeScript"),Object(l.a)("ul",null,Object(l.a)("li",null,"Введение"),Object(l.a)("li",null,"Странности",Object(l.a)("ul",null,Object(l.a)("li",null,"Зацикленные модули"),Object(l.a)("li",null,"Манкипатчинг"))),Object(l.a)("li",null,"Typescript"))),mdxType:"Card"},c="Card",(o="mdxType")in n?Object.defineProperty(n,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[o]=c,n)));var n,o,c}],m=[{}],p={};function d(e){var n=e.components,o=u(e,["components"]);return Object(l.a)("wrapper",c({},p,o,{components:n,mdxType:"MDXLayout"}),Object(l.a)(a.a,{left:Object(l.a)("img",{src:t(13)}),right:Object(l.a)("div",{className:"alignleft"},Object(l.a)("h1",null,"Модули в Node.js и TypeScript"),Object(l.a)("ul",null,Object(l.a)("li",null,"Введение"),Object(l.a)("li",null,"Странности",Object(l.a)("ul",null,Object(l.a)("li",null,"Зацикленные модули"),Object(l.a)("li",null,"Манкипатчинг"))),Object(l.a)("li",null,"Typescript"))),mdxType:"Card"}))}d.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return s})),t.d(n,"fusumaProps",(function(){return m})),t.d(n,"default",(function(){return d}));var a=t(5),o=t(2),r=t.n(o),l=t(1);function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}function u(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=[function(e){return Object(l.a)(r.a.Fragment,null,Object(l.a)(a.a,(n={right:Object(l.a)("img",{src:t(14)}),left:Object(l.a)("div",{className:"alignleft"},Object(l.a)("h1",null,"Введение"),Object(l.a)("p",null,"ECMAScript Modules vs. CommonJS")),mdxType:"Card"},c="Card",(o="mdxType")in n?Object.defineProperty(n,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[o]=c,n)));var n,o,c}],m=[{sectionTitle:"Введение ECMAScript Modules vs. CommonJS",note:"Модули в js это независимые куски изолированного кода которые можно переиспользовать.\nУ них может быть разный функционал, который можно редактировать незатрагивая другие модули.\nМодули выполняются не в глобальной, а в своей собственной области видимости.\nЭто означает, что переменные, функции, классы и т.д., объявленные в модуле, не видны вне модуля, за исключением тех случаев, когда они явно экспортированы.\nЧтобы использовать переменную, функцию, класс, интерфейс, и т.д., экспортированные из другого модуля, необходимо импортировать их."}],p={};function d(e){var n=e.components,o=u(e,["components"]);return Object(l.a)("wrapper",c({},p,o,{components:n,mdxType:"MDXLayout"}),Object(l.a)(a.a,{right:Object(l.a)("img",{src:t(14)}),left:Object(l.a)("div",{className:"alignleft"},Object(l.a)("h1",null,"Введение"),Object(l.a)("p",null,"ECMAScript Modules vs. CommonJS")),mdxType:"Card"}))}d.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"CommonJS"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports.add = (a, b) => a + b\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"const { add } = require('./math-module')\nadd(3, 7) // 10\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Require"),Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"1. node ~/workspace/index.js\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"1. node ~/workspace/index.js\n\n2. Paths [\n  '~/workspace/node_modules',\n  '~/node_modules',\n  '~/../node_modules',\n  '~/../../node_modules'\n]\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"1. node ~/workspace/index.js\n\n2. Paths [\n  '~/workspace/node_modules',\n  '~/node_modules',\n  '~/../node_modules',\n  '~/../../node_modules'\n]\n\n3. ~/workspace/node_modules/lodash/index.js\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"module.exports.add = (a, b) => a + b\n")),Object(r.a)("p",null,"В NodeJS выполняется как:"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"function (exports, require, module, __filename, __dirname) {\n    module.exports.add = (a, b) => a + b\n}\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))),Object(r.a)("p",null,Object(r.a)("inlineCode",{parentName:"p"},"delete require.cache['lodash']")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Module"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"module.exports.add = (a, b) => a + b\nconsole.log(module)\n\nnode ~/workspace/index.js \n\nModule {\n    id: '.',\n    path: '~/workspace',\n    exports: { add: [Function (anonymous)] },\n    parent: null,\n    filename: '~/workspace/index.js',\n    loaded: false,\n    children: [],\n    paths: [\n        '~/workspace/node_modules',\n        '~/node_modules',\n        '~/../node_modules',\n        '~/../../node_modules'\n    ]\n}\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Export"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports = (a, b) => a - b\nmodule.exports.add = (a, b) => a + b\n\n// index.js\nconst math = require('./math-module')\n\nmath(5, 1) // 4\nmath.add(5, 1) // 6\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports.add = (a, b) => a + b\nmodule.exports = (a, b) => a - b\n\n// index.js\nconst math = require('./math-module')\n\nmath(5, 1) // 4\nmath.add(5, 1) // error\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports = 2\nmodule.exports.add = (a, b) => a + b\n\n// index.js\nconst math = require('./math-module')\n\nmath // 2\nmath.add(5, 1) // error\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nexports.add = (a, b) => a + b\n\n// index.js\nconst math = require('./math-module')\n\nmath.add(5, 1) // 6\n")))}],s=[{sectionTitle:"CommonJS",note:"В Node.js реализована своя модульная система, определенная CommonJS спецификацией. \nДля подключения зависимостей используется глобальная функция `require()`, которая принимает первым параметром строку с путем к модулю. \nДля экспортирования интерфейса модуля используется `module.exports`. \nКаждый импортируемый модуль загружается один за другим в указанной последовательности."},{sectionTitle:"CommonJS (Require)",note:"Что же происходит при вызове require.\n\n1. Resolution. Поиск файла в системе. Зависит от того как мы указали модуль. Если мы укажем только название модуля `lodash` то поиск будет происходить в начале по встроенным модулям а затем рекурсивно, каждый раз переходя в родительскую папку, будет искать папку node_modules с нужным модулем."},{},{},{note:"NodeJs начинает резолвить путь к модулю.\nСначала он ищет среди нативных модулей, затем заходит в папки node_modules относительно директории в которой был вызван require.\nПереходя директорией выше до корневой папки системы. \n\nЗаходя в node_modules сначала происходит поиск папки по имени модуля. Дальше Node.js сам попытается определить какой из файлов папки представляет собой точку входа для модуля. Для начала будет проверено или существует в папке файл package.json в котором будет указано в поле main имя файла, который нужно подключить. Если файла package.json нету, тогда Node.js попытается подключить файлы &#x27;index.js&#x27; или &#x27;index.node&#x27;."},{},{note:"Далее происходить загрузка модуля. Под этим подразумевается загрузка текстового содержимого файла в память. Node.js в настоящее время предполагает, что файл является модулем CommonJS. Но если загружается встроенным модулем NodeJS, то загрузка включает динамическую привязку указанной библиотеки к текущему процессу Node.js. На данном этапе код не выполняется."},{note:"Перед передачей загруженного текста JavaScript в виртуальную машину для исполнения, весь переданный код переносится внутрь функции.\n\nРазличные global артефакты, такие как export, module, __filename и __dirname, которые обычно используются в модулях Node.js, фактически не являются глобальными значениями в традиционном смысле JavaScript. Вместо этого они являются функциональными параметрами, значения которых передаются Node.js в функцию-обёртку при вызове."},{note:"Затем код выполняется в exports записываются функции и свойства. Как только функция-обертка возвращается, объект exports кэшируется, а затем отдаётся как возвращаемое значение для метода require()."},{note:"Независимо от того как вы подключаете модуль, он кэшируется сразу после подключения. Это означает, что сколько бы раз не подключался модуль, его код исполнится только один раз.\n\nЭто поведение можно изменить, если после каждого вызова модуля удалять его из кэша."},{sectionTitle:"CommonJS (Module)",note:"Рассмотрим быстренько из чего состоит модуль. То что кешируется как раз.\n\ncache[id] = Module\n\nявляется ли модуль зависимостью\n`module.children` хранит модули которые вызывает текущий модуль\n\nзагрузка происходит в одном цикле ивент лупа поэтому loaded: false\nесли мы вызовем консоль в след цикле то флаг будет true\n\nsetImmediate(() =&gt; {\n  console.log(module)\n})"},{sectionTitle:"CommonJS (Export)",note:"Для экспорта модуля в `module` есть объект `exports` в которые записываем все что хотим экспортировать из модуля\n\nМожно присваивать конкретно `exports`, тогда при иморте он будет использоваться по дефолту. Можно указывать конкретное имя экспорта. Используется если мы хотим экспортировать несколько элементов из модуля.\n\nmodule.exports = default\n\nexports = {} not working only export.key = value, exports doesn&#x27;t have default export"}],m={};function p(e){var n=e.components,a=l(e,["components"]);return Object(r.a)("wrapper",c({},m,a,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"CommonJS"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports.add = (a, b) => a + b\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"const { add } = require('./math-module')\nadd(3, 7) // 10\n")),Object(r.a)("hr",null),Object(r.a)("h1",null,"Require"),Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"1. node ~/workspace/index.js\n")),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"1. node ~/workspace/index.js\n\n2. Paths [\n  '~/workspace/node_modules',\n  '~/node_modules',\n  '~/../node_modules',\n  '~/../../node_modules'\n]\n")),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst _ = require('lodash')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"1. node ~/workspace/index.js\n\n2. Paths [\n  '~/workspace/node_modules',\n  '~/node_modules',\n  '~/../node_modules',\n  '~/../../node_modules'\n]\n\n3. ~/workspace/node_modules/lodash/index.js\n")),Object(r.a)("hr",null),Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"module.exports.add = (a, b) => a + b\n")),Object(r.a)("p",null,"В NodeJS выполняется как:"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"function (exports, require, module, __filename, __dirname) {\n    module.exports.add = (a, b) => a + b\n}\n")),Object(r.a)("hr",null),Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))),Object(r.a)("hr",null),Object(r.a)("p",null,Object(r.a)("img",c({src:t(3)},{alt:"require flow"}))),Object(r.a)("p",null,Object(r.a)("inlineCode",{parentName:"p"},"delete require.cache['lodash']")),Object(r.a)("hr",null),Object(r.a)("h1",null,"Module"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"module.exports.add = (a, b) => a + b\nconsole.log(module)\n\nnode ~/workspace/index.js \n\nModule {\n    id: '.',\n    path: '~/workspace',\n    exports: { add: [Function (anonymous)] },\n    parent: null,\n    filename: '~/workspace/index.js',\n    loaded: false,\n    children: [],\n    paths: [\n        '~/workspace/node_modules',\n        '~/node_modules',\n        '~/../node_modules',\n        '~/../../node_modules'\n    ]\n}\n")),Object(r.a)("hr",null),Object(r.a)("h1",null,"Export"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports = (a, b) => a - b\nmodule.exports.add = (a, b) => a + b\n\n// index.js\nconst math = require('./math-module')\n\nmath(5, 1) // 4\nmath.add(5, 1) // 6\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports.add = (a, b) => a + b\nmodule.exports = (a, b) => a - b\n\n// index.js\nconst math = require('./math-module')\n\nmath(5, 1) // 4\nmath.add(5, 1) // error\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports = 2\nmodule.exports.add = (a, b) => a + b\n\n// index.js\nconst math = require('./math-module')\n\nmath // 2\nmath.add(5, 1) // error\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nexports.add = (a, b) => a + b\n\n// index.js\nconst math = require('./math-module')\n\nmath.add(5, 1) // 6\n")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"ECMAScript"))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,Object(r.a)("inlineCode",{parentName:"h1"},"import _ from 'lodash'")),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"имя модуля ",Object(r.a)("inlineCode",{parentName:"li"},"lodash"),", подключается entry point модуля указынный в package.json"),Object(r.a)("li",{parentName:"ul"},"явный путь к модулю ",Object(r.a)("inlineCode",{parentName:"li"},"lodash/repeat.js")),Object(r.a)("li",{parentName:"ul"},"относительные пути к модулю ",Object(r.a)("inlineCode",{parentName:"li"},"./ ../")),Object(r.a)("li",{parentName:"ul"},"абсолютные пути ",Object(r.a)("inlineCode",{parentName:"li"},"file:///opt/nodejs/config.js"))))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// module.mjs\nexport default (a, b) => a - b\nexport const add = (a, b) => a + b\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.mjs\nimport math, { add } from './module.mjs'\n\nmath(5, 1) // 4\nadd(5, 1) // 6\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"(async () => {\n  const module = await import(`lodash`)\n  console.log(module.default.capitalize('test')) // Test\n})()\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"export / import"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"//index.mjs\nexport default 1\nexport const value = 3\nexport { sampleSize as randomItems } from 'lodash'\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import m, { value, randomItems } from './index.mjs'\nm // 1\nvalue // 3\nrandomItems([1, 2, 3], 2) // [3, 1]\n\nimport * as result from './index.mjs'\nresult.default // 1\nresult.value // value3\nresult.randomItems([1, 2, 3], 2) // [3, 1]\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Для активации необходимо:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"расширение .mjs (recommended)"),Object(r.a)("li",{parentName:"ul"},"package.json ",Object(r.a)("inlineCode",{parentName:"li"},'"type": "module"')),Object(r.a)("li",{parentName:"ul"},"flag ",Object(r.a)("inlineCode",{parentName:"li"},"--input-type=module"))),Object(r.a)("blockquote",null,Object(r.a)("p",{parentName:"blockquote"},".mjs всегда загружается как es модуль несмотря на package.json")))}],s=[{sectionTitle:"ECMAScript",note:"Позволяют импортировать синхронно и асинхронно. Изначально был введен в браузерах. \nВ nodejs реализовали поведение максимально приближенное к браузерному. Сделано это для того чтобы можно было переиспользовать код на фронте и беке."},{sectionTitle:"ECMAScript (Import)",note:"Коротко\nДля подключение модуля используется конструкция `import module from &#x27;path&#x27;`"},{note:"Во время анализа кода создается статический список символов, экспортируемый модулем. Они идентифицируются парсером, который ищет использование ключевого слова export. И на данном этапе символы ни на что не указывают. Во время выполнения кода будут созданы сущности символов.\n\nКлючевым моментом является то, что определение, какие символы экспортируются с помощью ESM, происходит перед исполнением кода.\n\nПервый шаг: загрузка содержимого файла с диска в основном такая же, но может проиcходить асинхронно. \nКогда содержимое файла доступно, оно анализируется. При синтаксическом анализе форма модуля, определяемая инструкциями экспорта, определяется до выполнения кода. \nКак только форма определена, код исполняется. \n\nВажно помнить, что все инструкции import и export решают их цели до того, как какой-либо код будет выполнен на самом деле. Важно также отметить, что спецификация ES6 позволяет исполнить этот шаг разрешения асинхронно. В терминах Node.js это означает, что загрузка кода приложения, разрешение импортов и экспортов модуля и исполнение кода модуля будут происходить в течении нескольких циклов Event Loop.\n\n1. Построение (constuction) — поиск, загрузка и парсинг файлов. (резолв пути к файлу, загрузка)\n2. Создание экземпляра (instantiation) — создается статический список символов экспортируемых модулем и поиск ячеек в памяти для размещения значений этих символов. Символы идентифицируются парсером, который ищет использование ключевого слова export.\n3. Оценка (evaluation)— запуск кода для заполнения этих полей фактическими значениями переменных.\n\nВсе эти этапы могут выполняться отдельно. Это и создает асинхронность."},{note:"рассказать о примерах, пояснить что нет разницы что экспортируешь в дефолте\n\nпоказать переименование в экспорте"},{sectionTitle:"ECMAScript (Activate)"}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"ECMAScript"),Object(r.a)("hr",null),Object(r.a)("h1",null,Object(r.a)("inlineCode",{parentName:"h1"},"import _ from 'lodash'")),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"имя модуля ",Object(r.a)("inlineCode",{parentName:"li"},"lodash"),", подключается entry point модуля указынный в package.json"),Object(r.a)("li",{parentName:"ul"},"явный путь к модулю ",Object(r.a)("inlineCode",{parentName:"li"},"lodash/repeat.js")),Object(r.a)("li",{parentName:"ul"},"относительные пути к модулю ",Object(r.a)("inlineCode",{parentName:"li"},"./ ../")),Object(r.a)("li",{parentName:"ul"},"абсолютные пути ",Object(r.a)("inlineCode",{parentName:"li"},"file:///opt/nodejs/config.js"))),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// module.mjs\nexport default (a, b) => a - b\nexport const add = (a, b) => a + b\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.mjs\nimport math, { add } from './module.mjs'\n\nmath(5, 1) // 4\nadd(5, 1) // 6\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"(async () => {\n  const module = await import(`lodash`)\n  console.log(module.default.capitalize('test')) // Test\n})()\n")),Object(r.a)("hr",null),Object(r.a)("h1",null,"export / import"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"//index.mjs\nexport default 1\nexport const value = 3\nexport { sampleSize as randomItems } from 'lodash'\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import m, { value, randomItems } from './index.mjs'\nm // 1\nvalue // 3\nrandomItems([1, 2, 3], 2) // [3, 1]\n\nimport * as result from './index.mjs'\nresult.default // 1\nresult.value // value3\nresult.randomItems([1, 2, 3], 2) // [3, 1]\n")),Object(r.a)("hr",null),Object(r.a)("h1",null,"Для активации необходимо:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"расширение .mjs (recommended)"),Object(r.a)("li",{parentName:"ul"},"package.json ",Object(r.a)("inlineCode",{parentName:"li"},'"type": "module"')),Object(r.a)("li",{parentName:"ul"},"flag ",Object(r.a)("inlineCode",{parentName:"li"},"--input-type=module"))),Object(r.a)("blockquote",null,Object(r.a)("p",{parentName:"blockquote"},".mjs всегда загружается как es модуль несмотря на package.json")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Главные различия"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"esm in use strict;"),Object(r.a)("li",{parentName:"ul"},"для es6 расширения должны быть явно указаны, исключением являются сторонние и внутренние модули"),Object(r.a)("li",{parentName:"ul"},"NODE_PATH - переменная которая указывает еще одно место для поиска модуля, в es недоступно, нужно использовать ",Object(r.a)("inlineCode",{parentName:"li"},"symlinks")),Object(r.a)("li",{parentName:"ul"},"нет ",Object(r.a)("inlineCode",{parentName:"li"},"require, exports, module.exports, __filename, __dirname")," но можно импортировать из встроенных модулей"),Object(r.a)("li",{parentName:"ul"},"расположение import в коде не зависит от порядка загрузки в отличии от require")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import { fileURLToPath } from 'url';\nimport { dirname } from 'path';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import { createRequire } from 'module';\nconst require = createRequire(import.meta.url);\n\n// sibling-module.js is a CommonJS module.\nconst siblingModule = require('./sibling-module');\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"export default { a: 1 }\nexport const val = 3\n\nconst res = require('./index.mjs')\nconsole.log(res)\n\n// Must use import to load ES Module: /Users/renat/workspace/learning/workshop/modules/index.mjs\n\n(async function() {\n  const res = await import('./index.mjs');\n  console.log(res);\n})()\n// { default: { a: 1 }, val: 3 }\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// common.js\nmodule.exports = {v: 1}\nmodule.exports.add = (a, b) => a + b\n\n// index.mjs\nimport res from './common.js'\nOK\n")))}],s=[{sectionTitle:"Главные различия",note:"Критически важным для понимания разницы между модулями CommonJS и ES6 является тот факт, что форма (API) модуля CommonJS не может быть определена до тех пор, пока код не будет выполнен."}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"Главные различия"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"esm in use strict;"),Object(r.a)("li",{parentName:"ul"},"для es6 расширения должны быть явно указаны, исключением являются сторонние и внутренние модули"),Object(r.a)("li",{parentName:"ul"},"NODE_PATH - переменная которая указывает еще одно место для поиска модуля, в es недоступно, нужно использовать ",Object(r.a)("inlineCode",{parentName:"li"},"symlinks")),Object(r.a)("li",{parentName:"ul"},"нет ",Object(r.a)("inlineCode",{parentName:"li"},"require, exports, module.exports, __filename, __dirname")," но можно импортировать из встроенных модулей"),Object(r.a)("li",{parentName:"ul"},"расположение import в коде не зависит от порядка загрузки в отличии от require")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import { fileURLToPath } from 'url';\nimport { dirname } from 'path';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import { createRequire } from 'module';\nconst require = createRequire(import.meta.url);\n\n// sibling-module.js is a CommonJS module.\nconst siblingModule = require('./sibling-module');\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"export default { a: 1 }\nexport const val = 3\n\nconst res = require('./index.mjs')\nconsole.log(res)\n\n// Must use import to load ES Module: /Users/renat/workspace/learning/workshop/modules/index.mjs\n\n(async function() {\n  const res = await import('./index.mjs');\n  console.log(res);\n})()\n// { default: { a: 1 }, val: 3 }\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// common.js\nmodule.exports = {v: 1}\nmodule.exports.add = (a, b) => a + b\n\n// index.mjs\nimport res from './common.js'\nOK\n")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Cycles"))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// a.js\nconst ModuleB = require('./b')\n\nfunction ModuleA() {}\nModuleA.hello = function () {\n  const b = new ModuleB()\n  console.log('hello! ' + b.name)\n}\nconsole.log('ModuleA')\n\nmodule.exports = ModuleA\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// b.js\nconst moduleA = require('./a')\n\nfunction ModuleB() {\n  this.name = 'ModuleB'\n}\n\nModuleB.hello = function () {\n  moduleA.hello()\n}\n\nconst b = new ModuleB()\nconsole.log(b.name) // ModuleB\n\nmodule.exports = ModuleB\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst moduleB = require('./b')\nmoduleB.hello()\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"ModuleA\nModuleB\na.js:5\n  const b = new ModuleB()\n            ^\n\nTypeError: ModuleB is not a constructor\n")))}],s=[{sectionTitle:"Quirks (Cycles)",note:"При использовании нескольких модулей может возникнуть круговая зависимость и при выполнении кода мы получим ошибку"},{},{}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"Cycles"),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// a.js\nconst ModuleB = require('./b')\n\nfunction ModuleA() {}\nModuleA.hello = function () {\n  const b = new ModuleB()\n  console.log('hello! ' + b.name)\n}\nconsole.log('ModuleA')\n\nmodule.exports = ModuleA\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// b.js\nconst moduleA = require('./a')\n\nfunction ModuleB() {\n  this.name = 'ModuleB'\n}\n\nModuleB.hello = function () {\n  moduleA.hello()\n}\n\nconst b = new ModuleB()\nconsole.log(b.name) // ModuleB\n\nmodule.exports = ModuleB\n")),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// index.js\nconst moduleB = require('./b')\nmoduleB.hello()\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"ModuleA\nModuleB\na.js:5\n  const b = new ModuleB()\n            ^\n\nTypeError: ModuleB is not a constructor\n")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Solution"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// a.js\nconst ModuleB = require('./b')\n\nfunction ModuleA() {}\nModuleA.hello = function () {\n  const b = new ModuleB()\n  console.log('hello! ' + b.name)\n}\nconsole.log('ModuleA')\n\nmodule.exports = ModuleA\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// b.js\nfunction ModuleB() {\n  this.name = 'ModuleB'\n}\n\nmodule.exports = ModuleB\n\nconst moduleA = require('./a')\n\nModuleB.hello = function () {\n  moduleA.hello()\n}\n\nconst b = new ModuleB()\nconsole.log(b.name)\n")))}],s=[{note:"нужно экспортировать раньше"}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"Solution"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// a.js\nconst ModuleB = require('./b')\n\nfunction ModuleA() {}\nModuleA.hello = function () {\n  const b = new ModuleB()\n  console.log('hello! ' + b.name)\n}\nconsole.log('ModuleA')\n\nmodule.exports = ModuleA\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// b.js\nfunction ModuleB() {\n  this.name = 'ModuleB'\n}\n\nmodule.exports = ModuleB\n\nconst moduleA = require('./a')\n\nModuleB.hello = function () {\n  moduleA.hello()\n}\n\nconst b = new ModuleB()\nconsole.log(b.name)\n")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"ECMAScript"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import ModuleB from './b.mjs'\n\nfunction ModuleA() {}\nModuleA.hello = function () {\n  const b = new ModuleB()\n  console.log('hello! ' + b.name)\n}\n\nexport default ModuleA\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import moduleA from './a.mjs'\n\nfunction ModuleB() {\n  this.name = 'ModuleB'\n}\n\nModuleB.hello = function () {\n  moduleA.hello()\n}\n\nconst b = new ModuleB()\nconsole.log(b.name)\n\nexport default ModuleB\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import moduleB from './b.mjs'\nmoduleB.hello()\n")))}],s=[{note:"При синтаксическом анализе форма модуля, определяемая инструкциями экспорта, определяется до выполнения кода."}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"ECMAScript"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import ModuleB from './b.mjs'\n\nfunction ModuleA() {}\nModuleA.hello = function () {\n  const b = new ModuleB()\n  console.log('hello! ' + b.name)\n}\n\nexport default ModuleA\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import moduleA from './a.mjs'\n\nfunction ModuleB() {\n  this.name = 'ModuleB'\n}\n\nModuleB.hello = function () {\n  moduleA.hello()\n}\n\nconst b = new ModuleB()\nconsole.log(b.name)\n\nexport default ModuleB\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import moduleB from './b.mjs'\nmoduleB.hello()\n")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Monkey patching"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import _ from 'lodash'\nimport repeat from 'lodash/repeat.js'\n\nconst str = 'tools'\n\nconsole.log(_.repeat(str, 2)) // toolstools\n\n_.repeat = function(string, n, ...args) {\n  const separator = ':'\n  return repeat(string + separator, n, ...args).replace(new RegExp(separator + '$'), '')\n}\n\nconsole.log(_.repeat(str, 2)) // tools:tools\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import _ from 'lodash'\nimport './index.js'\n\nconst str = 'tools'\n\nconsole.log(_.repeat(str, 2)) // tools:tools\n")))}],s=[{sectionTitle:"Quirks (Monkey patching)",note:"Иногда необходимо подправить сторонний модуль. Добавить функционал или изменить формат ответа. Реализовать это можно динамически. Данную манипуляцию нужно проводить в редких случаях и аккуратно. Так как порождает сайд эффекты которые невозможно контролировать не зная об этих изменениях.\n\nНельзя изменять npm пакеты локально. Так как эти изменения перезапишутся при обновлении зависимостей и их невозможно перенести в сборку.\nМы можем импортировать библиотеку и только потом внести изменения."},{note:"Если импортировать модуль с патчем в другой модуль, то там так же будет подмена метода."}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"Monkey patching"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import _ from 'lodash'\nimport repeat from 'lodash/repeat.js'\n\nconst str = 'tools'\n\nconsole.log(_.repeat(str, 2)) // toolstools\n\n_.repeat = function(string, n, ...args) {\n  const separator = ':'\n  return repeat(string + separator, n, ...args).replace(new RegExp(separator + '$'), '')\n}\n\nconsole.log(_.repeat(str, 2)) // tools:tools\n")),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"import _ from 'lodash'\nimport './index.js'\n\nconst str = 'tools'\n\nconsole.log(_.repeat(str, 2)) // tools:tools\n")))}p.isMDXComponent=!0},function(e,n,t){"use strict";t.r(n),t.d(n,"slides",(function(){return u})),t.d(n,"fusumaProps",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),o=t.n(a),r=t(1);function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var u=[function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h1",null,"Модули в Typescript"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"// module.ts\nexport = (a, b) => a + b\n\n// index.ts\nimport math = require('./module')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"// module.ts\nexport const add = (a, b) => a + b\n\n// index.ts\nimport { add } from './module'\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h2",null,"Внешние модули"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports.add = (a, b) => a + b\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),'// index.d.ts\ndeclare module "math-module" {\n  export function add(a: number, b: number): number\n}\n\n// declare module "math-module"\n')),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"// index.ts\nimport { add } from '../math-module'\n\nconsole.log(add(1, 2)) // 3\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"import { add as esAdd } from '../../math-module'\nimport add = require('../../math-module')\nconst { add: cAdd } = require('../../math-module')\n\nconsole.log(add.add(1, 2)) // 3\nconsole.log(esAdd(1, 2)) // 3\nconsole.log(cAdd(1, 2)) // 3\n")))},function(e){return Object(r.a)(o.a.Fragment,null,Object(r.a)("h2",null,"Укороченные пути к модулям проекта в TypeScript"),Object(r.a)("p",null,Object(r.a)("inlineCode",{parentName:"p"},"import { User } from '../../user/model' vs import { User } from 'user/model'")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'// tsconfig.json\n{\n    "compilerOptions": {\n        "baseUrl": "src"\n    }\n}\n')))}],s=[{sectionTitle:"Typescript",note:"Тайпскрипт поддерживает концепцию ES6 модулей. Модули импортируют друг друга, используя загрузчик модулей JS движка. В nodejs это commonjs, в браузерном js это es. Рассмотрим особенности.\n\nВ тайпскрипте можно использовать `export` и `export =`.\n\nДля импорта модуля, экспортированного с помощью export =, должна быть использована специфичная для TypeScript конструкция import let = require(&quot;module&quot;)."},{note:"Внешние незадекларированные модули можно декларировать самостоятельно"},{},{note:"Используя параметр `baseUrl` в tsconfig можно указать относительно какого пути искать модули в первую очередь.\nУказывая `baseUrl: &#x27;src&#x27;` при импорте `components/MyComponent` компилятор в первую очередь зайдет в папку `src` проекта а затем уже в `node_modules`. Точнее он подставит в импорт после компиляции путь `/src` в итоге получится `/src/components/MyComponent`"}],m={};function p(e){var n=e.components,t=l(e,["components"]);return Object(r.a)("wrapper",c({},m,t,{components:n,mdxType:"MDXLayout"}),Object(r.a)("h1",null,"Модули в Typescript"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"// module.ts\nexport = (a, b) => a + b\n\n// index.ts\nimport math = require('./module')\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"// module.ts\nexport const add = (a, b) => a + b\n\n// index.ts\nimport { add } from './module'\n")),Object(r.a)("hr",null),Object(r.a)("h2",null,"Внешние модули"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-js"}),"// math-module.js\nmodule.exports.add = (a, b) => a + b\n")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),'// index.d.ts\ndeclare module "math-module" {\n  export function add(a: number, b: number): number\n}\n\n// declare module "math-module"\n')),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"// index.ts\nimport { add } from '../math-module'\n\nconsole.log(add(1, 2)) // 3\n")),Object(r.a)("hr",null),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{className:"language-typescript"}),"import { add as esAdd } from '../../math-module'\nimport add = require('../../math-module')\nconst { add: cAdd } = require('../../math-module')\n\nconsole.log(add.add(1, 2)) // 3\nconsole.log(esAdd(1, 2)) // 3\nconsole.log(cAdd(1, 2)) // 3\n")),Object(r.a)("hr",null),Object(r.a)("h2",null,"Укороченные пути к модулям проекта в TypeScript"),Object(r.a)("p",null,Object(r.a)("inlineCode",{parentName:"p"},"import { User } from '../../user/model' vs import { User } from 'user/model'")),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'// tsconfig.json\n{\n    "compilerOptions": {\n        "baseUrl": "src"\n    }\n}\n')))}p.isMDXComponent=!0}],[[17,6,7]],[1,9]]);